<Window
    x:Class="VideoManager2_WinUI.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:VideoManager2_WinUI"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:controls="using:CommunityToolkit.WinUI.UI.Controls"
    mc:Ignorable="d"
    Title="VideoManager2_WinUI">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/> <!-- ツールバー用 -->
            <RowDefinition Height="*"/>   <!-- メインコンテンツ用 -->
        </Grid.RowDefinitions>

        <!-- 上部ツールバーエリア -->
        <CommandBar Grid.Row="0">
            <AppBarButton Icon="Folder" Label="ライブラリを開く" Command="{x:Bind ViewModel.SelectFolderCommand}"/>
            <!-- 今後、他のコマンドボタンを追加 -->
        </CommandBar>

        <!-- メインコンテンツエリア (3ペイン) -->
        <Grid Grid.Row="1" Padding="12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="250" MinWidth="150"/> <!-- 左ペイン (タグ) -->
                <ColumnDefinition Width="Auto"/>               <!-- GridSplitter -->
                <ColumnDefinition Width="*"/>                  <!-- 右ペイン (ファイル一覧) -->
            </Grid.ColumnDefinitions>

            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>                    <!-- 上部 (タグツリーとファイル一覧) -->
                <RowDefinition Height="Auto"/>                 <!-- GridSplitter -->
                <RowDefinition Height="150" MinHeight="100"/> <!-- 下部ペイン (詳細情報) -->
            </Grid.RowDefinitions>

            <!-- 左ペイン: タグツリー -->
            <Grid Grid.Row="0" Grid.Column="0" BorderBrush="Gray" BorderThickness="0,0,1,0" Padding="0,0,12,0">
                <TreeView>
                    <!-- TODO: タグデータをここにバインドする -->
                </TreeView>
            </Grid>

            <!-- GridSplitter (縦) -->
            <controls:GridSplitter Grid.Row="0" Grid.Column="1" Width="12" HorizontalAlignment="Center" VerticalAlignment="Stretch" Background="Transparent"/>

            <!-- 右ペイン: ファイル一覧 -->
            <Grid Grid.Row="0" Grid.Column="2">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <!-- 右ペインのツールバー -->
                <CommandBar Grid.Row="0" DefaultLabelPosition="Right">
                    <AppBarButton Icon="List" Label="リスト表示"/>
                    <AppBarButton Icon="ViewAll" Label="サムネイル表示"/>
                    <AppBarSeparator/>
                    <AppBarElementContainer>
                        <Slider Width="150" Minimum="100" Maximum="400" StepFrequency="10" Value="200" VerticalAlignment="Center"/>
                    </AppBarElementContainer>
                    <AppBarSeparator/>
                    <AppBarElementContainer>
                         <ComboBox Header="並び替え" PlaceholderText="名前 昇順" MinWidth="150">
                            <!-- TODO: ソート項目を追加 -->
                         </ComboBox>
                    </AppBarElementContainer>
                    <CommandBar.SecondaryCommands>
                        <!-- TODO: 他のコマンド -->
                    </CommandBar.SecondaryCommands>
                </CommandBar>

                <!-- ファイル表示エリア (GridView) -->
                <GridView
                    Grid.Row="1"
                    ItemsSource="{x:Bind ViewModel.VideoItems}"
                    IsItemClickEnabled="False"
                    SelectionMode="Single"
                    Padding="12,0,0,0">
                    <GridView.ItemTemplate>
                        <DataTemplate x:DataType="local:VideoItem">
                            <StackPanel Width="200" Padding="8" Spacing="4">
                                <!-- サムネイル画像 -->
                                <Image
                                    Source="{x:Bind Thumbnail, Mode=OneWay}"
                                    Width="200"
                                    Height="120"
                                    Stretch="UniformToFill">
                                    <Image.ContextFlyout>
                                        <MenuFlyout>
                                            <MenuFlyoutItem Text="再生" />
                                            <MenuFlyoutItem Text="タグを編集" />
                                            <MenuFlyoutItem Text="ファイルの場所を開く" />
                                            <MenuFlyoutSeparator/>
                                            <MenuFlyoutItem Text="ごみ箱へ移動" />
                                        </MenuFlyout>
                                    </Image.ContextFlyout>
                                </Image>
                                <!-- ファイル名 -->
                                <TextBlock Text="{x:Bind FileName, Mode=OneWay}" TextWrapping="Wrap" MaxLines="2" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </DataTemplate>
                    </GridView.ItemTemplate>
                </GridView>
                <!-- TODO: ListViewをここに配置し、表示を切り替える -->
            </Grid>

            <!-- GridSplitter (横) -->
            <controls:GridSplitter Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="3" Height="12" HorizontalAlignment="Stretch" VerticalAlignment="Center" Background="Transparent"/>

            <!-- 下部ペイン: 詳細情報 -->
            <Grid Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="3" BorderBrush="Gray" BorderThickness="0,1,0,0" Padding="12">
                <!-- TODO: 選択されたアイテムの詳細情報をここにバインドする -->
                <StackPanel Spacing="8">
                    <TextBlock Text="ファイル名: (ここにファイル名)" FontWeight="Bold"/>
                    <TextBlock Text="更新日時: (ここに更新日時)" />
                    <TextBlock Text="ファイルサイズ: (ここにサイズ)" />
                    <TextBlock Text="動画の長さ: (ここに長さ)" />
                    <TextBlock Text="タグ:" />
                    <!-- TODO: タグ一覧をここに表示 -->
                </StackPanel>
            </Grid>
        </Grid>
    </Grid>
</Window>
